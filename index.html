<!-- Features Section -->
<section class="features" id="features">
    <h2 class="section-title">Why Choose PaySick</h2>
    <p class="section-subtitle">Simple, transparent payment solutions for your healthcare needs</p>
    <div class="feature-grid">
        <div class="feature-card">
            <div class="feature-icon">‚ö°</div>
            <h3>Instant Setup</h3>
            <p>Set up your payment plan in minutes. Quick verification process, immediate access to care.</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">üìÖ</div>
            <h3>3-Month Terms</h3>
            <p>All payments spread over three months. Simple, manageable installments that fit your budget.</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">üîí</div>
            <h3>Transparent Pricing</h3>
            <p>Clear upfront costs with no hidden fees. You know exactly what you'll pay from day one.</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">üè•</div>
            <h3>Wide Network</h3>
            <p>Accepted at thousands of healthcare providers nationwide. Find participating locations near you.</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">üì±</div>
            <h3>Easy Tracking</h3>
            <p>Monitor your payments, view schedules, and manage everything from your phone or computer.</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">üí¨</div>
            <h3>Dedicated Support</h3>
            <p>Real people ready to help with your payment questions anytime you need assistance.</p>
        </div>
    </div>
</section>

<!-- How It Works -->
<section class="how-it-works" id="how-it-works">
    <h2 class="section-title">How It Works</h2>
    <p class="section-subtitle">Get the care you need in three simple steps</p>
    <div class="steps">
        <div class="step">
            <div class="step-number">1</div>
            <h3>Sign Up</h3>
            <p>Quick registration process. Provide your information and get verified in minutes. Start immediately.</p>
        </div>
        <div class="step">
            <div class="step-number">2</div>
            <h3>Receive Care</h3>
            <p>Visit any participating healthcare provider. Show your PaySick account and receive the treatment you need.</p>
        </div>
        <div class="step">
            <div class="step-number">3</div>
            <h3>Pay in 3 Months</h3>
            <p>Your bill is automatically split into three equal monthly payments. Simple, predictable, stress-free.</p>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-section" id="start">
    <h2>Ready to simplify your healthcare payments?</h2>
    <p>Join thousands who've made medical expenses more manageable with PaySick</p>
    <button class="cta-white-btn" onclick="openModal()">Get Started Today</button>
</section>

<!-- Footer -->
<footer>
    <div class="footer-content">
        <div>
            <div class="footer-logo">Pay<span>Sick</span></div>
            <div class="footer-tagline">HEAL NOW, PAY LATER</div>
        </div>
        <div class="footer-links">
            <h4>Product</h4>
            <ul>
                <li><a href="#how-it-works">How It Works</a></li>
                <li><a href="#features">Payment Terms</a></li>
                <li><a href="#providers">Find Providers</a></li>
                <li><a href="#about">Mobile App</a></li>
            </ul>
        </div>
        <div class="footer-links">
            <h4>Company</h4>
            <ul>
                <li><a href="#about">About Us</a></li>
                <li><a href="#about">Careers</a></li>
                <li><a href="#about">Press</a></li>
                <li><a href="#about">Contact</a></li>
            </ul>
        </div>
        <div class="footer-links">
            <h4>Legal</h4>
            <ul>
                <li><a href="#about">Privacy Policy</a></li>
                <li><a href="#about">Terms of Service</a></li>
                <li><a href="#about">Licenses</a></li>
                <li><a href="#about">Accessibility</a></li>
            </ul>
        </div>
    </div>
    <div class="footer-bottom">
        &copy; 2026 PaySick. All rights reserved. | Payment services subject to eligibility.
    </div>
</footer>

<script>
    // Application state
    let currentStep = 1;
    let applicationStartTime = null;
    let applicationData = {};
    
    // Modal functions
    function openModal() {
        document.getElementById('applicationModal').classList.add('active');
        document.body.style.overflow = 'hidden';
        applicationStartTime = Date.now();
    }
    
    function closeModal() {
        document.getElementById('applicationModal').classList.remove('active');
        document.body.style.overflow = '';
        resetApplication();
    }
    
    function resetApplication() {
        currentStep = 1;
        updateProgressBar();
        document.querySelectorAll('.form-step').forEach(step => {
            step.classList.remove('active');
        });
        document.querySelector('[data-step="1"]').classList.add('active');
        document.querySelectorAll('input, select').forEach(input => {
            if (input.type !== 'checkbox') input.value = '';
            else input.checked = false;
        });
    }
    
    // Step navigation
    function nextStep() {
        if (!validateCurrentStep()) {
            return;
        }
        
        collectStepData();
        currentStep++;
        updateStep();
    }
    
    function previousStep() {
        currentStep--;
        updateStep();
    }
    
    function updateStep() {
        document.querySelectorAll('.form-step').forEach(step => {
            step.classList.remove('active');
        });
        document.querySelector(`.form-step[data-step="${currentStep}"]`).classList.add('active');
        updateProgressBar();
    }
    
    function updateProgressBar() {
        document.querySelectorAll('.progress-step').forEach((step, index) => {
            const stepNum = index + 1;
            step.classList.remove('active', 'completed');
            if (stepNum < currentStep) {
                step.classList.add('completed');
            } else if (stepNum === currentStep) {
                step.classList.add('active');
            }
        });
    }
    
    // Validation
    function validateCurrentStep() {
        const currentFormStep = document.querySelector(`.form-step[data-step="${currentStep}"]`);
        const inputs = currentFormStep.querySelectorAll('input[required], select[required]');
        
        for (let input of inputs) {
            if (!input.value || (input.type === 'checkbox' && !input.checked)) {
                input.focus();
                showError('Please fill in all required fields');
                return false;
            }
            
            // Email validation
            if (input.type === 'email' && !isValidEmail(input.value)) {
                input.focus();
                showError('Please enter a valid email address');
                return false;
            }
            
            // Phone validation
            if (input.id === 'phone' && !isValidPhone(input.value)) {
                input.focus();
                showError('Please enter a valid phone number');
                return false;
            }
            
            // Bill amount validation
            if (input.id === 'billAmount') {
                const amount = parseFloat(input.value);
                if (amount < 500 || amount > 800) {
                    input.focus();
                    showError('Bill amount must be between R500 and R800');
                    return false;
                }
            }
            
            // Age validation
            if (input.id === 'dob') {
                const age = calculateAge(new Date(input.value));
                if (age < 18) {
                    input.focus();
                    showError('You must be 18 or older to apply');
                    return false;
                }
            }
            
            // SSN validation
            if (input.id === 'ssn' && !/^\d{4}$/.test(input.value)) {
                input.focus();
                showError('Please enter your SA ID Number');
                return false;
            }
        }
        
        hideError();
        return true;
    }
    
    function isValidEmail(email) {
        return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
    }
    
    function isValidPhone(phone) {
        return /\d{10}/.test(phone.replace(/\D/g, ''));
    }
    
    function calculateAge(birthdate) {
        const today = new Date();
        let age = today.getFullYear() - birthdate.getFullYear();
        const monthDiff = today.getMonth() - birthdate.getMonth();
        if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthdate.getDate())) {
            age--;
        }
        return age;
    }
    
    function showError(message) {
        const errorEl = document.getElementById('errorMessage');
        errorEl.textContent = message;
        errorEl.classList.add('show');
    }
    
    function hideError() {
        const errorEl = document.getElementById('errorMessage');
        errorEl.classList.remove('show');
    }
    
    // Collect data
    function collectStepData() {
        const currentFormStep = document.querySelector(`.form-step[data-step="${currentStep}"]`);
        const inputs = currentFormStep.querySelectorAll('input, select');
        
        inputs.forEach(input => {
            if (input.id) {
                applicationData[input.id] = input.value;
            }
        });
    }
    
    // Risk scoring algorithm
    function calculateRiskScore(data) {
        let score = 100;
        const completionTime = (Date.now() - applicationStartTime) / 1000; // seconds
        
        // Behavioral signals
        if (completionTime < 60) score -= 10; // Too fast
        if (completionTime > 600) score -= 5;  // Too slow
        
        const hour = new Date().getHours();
        if (hour < 7 || hour > 22) score -= 5; // Unusual hours
        
        // Email domain check
        const emailDomain = data.email.split('@')[1];
        const disposableDomains = ['tempmail.com', 'guerrillamail.com', '10minutemail.com'];
        if (disposableDomains.some(d => emailDomain.includes(d))) {
            score -= 15;
        }
        
        // Healthcare context
        const billAmount = parseFloat(data.billAmount);
        if (billAmount > 1250) score -= 10; // Higher risk for larger amounts
        if (billAmount < 350) score -= 5;  // Unusually low
        
        if (data.existingPatient === 'no') score -= 10;
        if (data.treatmentType === 'urgent') score -= 5; // Slightly higher risk
        
        // Treatment type scoring
        const treatmentRisk = {
            'consultation': 0,
            'follow-up': 5,  // Lower risk
            'urgent': -5,
            'specialist': -5
        };
        score += treatmentRisk[data.treatmentType] || 0;
        
        return Math.max(0, Math.min(100, score));
    }
    
    // Submit application
    async function submitApplication() {
        if (!validateCurrentStep()) {
            return;
        }
        
        collectStepData();
        
        // Simulate processing
        const submitBtn = document.querySelector('.form-step[data-step="3"] .btn-next');
        submitBtn.disabled = true;
        submitBtn.textContent = 'Processing...';
        
        // Calculate risk score
        await new Promise(resolve => setTimeout(resolve, 2000)); // Simulate API call
        
        const riskScore = calculateRiskScore(applicationData);
        const billAmount = parseFloat(applicationData.billAmount);
        const monthlyPayment = (billAmount / 3).toFixed(2);
        
        // Determine approval
        let approved = false;
        let requiresReview = false;
        let maxApprovedAmount = 300;
        
        if (riskScore >= 85) {
            approved = true;
            maxApprovedAmount = 800;
        } else if (riskScore >= 70) {
            requiresReview = true;
            maxApprovedAmount = 500;
        }
        
        // Show result
        currentStep = 4;
        updateStep();
        displayResult(approved, requiresReview, billAmount, monthlyPayment, riskScore);
    }
    
    function displayResult(approved, requiresReview, billAmount, monthlyPayment, riskScore) {
        const resultContent = document.getElementById('resultContent');
        
        if (approved) {
            resultContent.innerHTML = `
                <div class="result-card">
                    <div class="result-icon success">‚úì</div>
                    <h3>Congratulations!</h3>
                    <p>Your application has been approved. You can now use PaySick at any participating provider.</p>
                    
                    <div class="approval-details">
                        <div class="approval-row">
                            <span>Bill Amount</span>
                            <span>$${billAmount.toFixed(2)}</span>
                        </div>
                        <div class="approval-row">
                            <span>Monthly Payment</span>
                            <span>$${monthlyPayment}</span>
                        </div>
                        <div class="approval-row">
                            <span>Number of Payments</span>
                            <span>3 months</span>
                        </div>
                        <div class="approval-row">
                            <span>Total Amount</span>
                            <span>$${billAmount.toFixed(2)}</span>
                        </div>
                    </div>
                    
                    <p style="font-size: 14px; color: #5A5A5A; margin-bottom: 20px;">
                        Your first payment will be due in 30 days. We'll send you reminders before each payment.
                    </p>
                    
                    <button class="primary-btn" onclick="closeModal()">Get Started</button>
                </div>
            `;
        } else if (requiresReview) {
            resultContent.innerHTML = `
                <div class="result-card">
                    <div class="result-icon review">‚è±</div>
                    <h3>Application Under Review</h3>
                    <p>Thank you for applying! We need a bit more time to review your application.</p>
                    
                    <div class="approval-details">
                        <div class="approval-row">
                            <span>Review Time</span>
                            <span>1-2 business days</span>
                        </div>
                        <div class="approval-row">
                            <span>Next Steps</span>
                            <span>We'll email you</span>
                        </div>
                    </div>
                    
                    <p style="font-size: 14px; color: #5A5A5A; margin-bottom: 20px;">
                        We'll contact you at ${applicationData.email} with a decision soon. Check your inbox for updates.
                    </p>
                    
                    <button class="primary-btn" onclick="closeModal()">Done</button>
                </div>
            `;
        } else {
            resultContent.innerHTML = `
                <div class="result-card">
                    <div class="result-icon review">‚Ñπ</div>
                    <h3>Unable to Approve</h3>
                    <p>We're unable to approve your application at this time, but we have other options for you.</p>
                    
                    <div class="approval-details">
                        <div class="approval-row">
                            <span>Alternative Option</span>
                            <span>Reduced Amount</span>
                        </div>
                        <div class="approval-row">
                            <span>Approved Amount</span>
                            <span>$${(billAmount * 0.5).toFixed(2)}</span>
                        </div>
                    </div>
                    
                    <p style="font-size: 14px; color: #5A5A5A; margin-bottom: 20px;">
                        You can reapply in 30 days, or contact our support team to discuss other payment options.
                    </p>
                    
                    <button class="secondary-btn" onclick="closeModal()" style="width: 100%; margin-bottom: 10px;">Close</button>
                    <button class="primary-btn" onclick="closeModal()">Contact Support</button>
                </div>
            `;
        }
    }
    
    // Close modal on outside click
    document.getElementById('applicationModal').addEventListener('click', function(e) {
        if (e.target === this) {
            closeModal();
        }
    });
    
    // Prevent form submission on Enter key
    document.addEventListener('keypress', function(e) {
        if (e.key === 'Enter' && e.target.tagName !== 'TEXTAREA') {
            e.preventDefault();
        }
    });
</script>